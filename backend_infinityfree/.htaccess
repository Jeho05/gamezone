RewriteEngine On

# CORS Headers pour Vercel
<IfModule mod_headers.c>
    # Autoriser les requetes depuis Vercel (VOUS DEVREZ METTRE L'URL EXACTE APRES LE DEPLOIEMENT)
    # Temporairement on autorise tout pour tester, puis vous mettrez l'URL precise
    Header set Access-Control-Allow-Origin "*"
    Header set Access-Control-Allow-Credentials "true"
    Header set Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
    Header set Access-Control-Allow-Headers "Content-Type, Authorization, X-Requested-With, Accept"
</IfModule>

# Handle preflight OPTIONS requests
RewriteCond %{REQUEST_METHOD} OPTIONS
RewriteRule ^(.*)$ $1 [R=200,L]

# Security - Proteger les fichiers sensibles
<FilesMatch "^\.env">
    Order allow,deny
    Deny from all
</FilesMatch>

<FilesMatch "\.(sql|md|txt)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# Redirect HTTP to API
DirectoryIndex index.php index.html

# Enable error display for debugging (DESACTIVER EN PRODUCTION)
php_flag display_errors Off
php_flag log_errors On
