import{r as a,w as Y}from"./react-vendor-Ct9RIpkg.js";import{j as e}from"./ui-vendor-Bm7JQX2T.js";import{R as G}from"./layout-DT9dxTg9.js";import{C as r}from"./PolymorphicComponent-CaeVC8po.js";import{N as S,a as b,C as T}from"./Navigation-uFWfAvUk.js";import{A as N}from"./apiBase-uKT1-15E.js";import{t as g}from"./index-Dwoj3kwW.js";import{C as I}from"./circle-x-BtKtckyT.js";import{Z as _}from"./zap-gCLMcZLD.js";import{C as A}from"./clock-Dw7Syj2h.js";import{T as z}from"./trending-up-Dz8cAqw-.js";import{A as F}from"./award-eSp6n4S5.js";import{I as q}from"./info-BLRu2m6m.js";import{A as J}from"./arrow-right-UwaTTyFQ.js";import{C as Z}from"./circle-alert-DV7sLuL2.js";import{R as H}from"./refresh-cw-CApMwsX6.js";import{C as E}from"./circle-check-big-Dl2mg9cX.js";import"./index-C7REL6_e.js";import"./gamepad-BKjcAtD2.js";import"./createLucideIcon-CyDeinbq.js";import"./users-DtBMk0sz.js";import"./star-BS7t5YYQ.js";import"./sparkles-Cq5HuY9N.js";import"./trophy-Tx3IvyeC.js";import"./x-DLYRcRbV.js";if(typeof window<"u"){const x={NEXT_PUBLIC_API_BASE:"https://votre-domaine.infinityfreeapp.com/api",NEXT_PUBLIC_KKIAPAY_PUBLIC_KEY:"072b361d25546db0aee3d69bf07b15331c51e39f",NEXT_PUBLIC_KKIAPAY_SANDBOX:"0"};globalThis.process??={};const i=globalThis.process.env??{};globalThis.process.env=new Proxy(Object.assign({},x,i),{get(o,l){return l in o?o[l]:void 0},has(){return!0}})}function W(){const[x,i]=a.useState(!0),[o,l]=a.useState(!1),[n,L]=a.useState(null),[w,$]=a.useState([]),[j,B]=a.useState(null),[m,D]=a.useState(null),[c,U]=a.useState(0),[d,f]=a.useState(0),[C,v]=a.useState(null),[k,K]=a.useState([]),p=n?Math.floor(d/n.points_per_minute):0,y=n&&d>=n.min_conversion_points&&d<=c&&(!n.max_minutes||p<=n.max_minutes)&&(!m||!n.max_conversion_per_day||m.remaining_today>0);a.useEffect(()=>{P(),R()},[]);const P=async()=>{try{i(!0);const s=await fetch(`${N}/player/convert_points.php`,{credentials:"include"});if(!s.ok)throw new Error("Erreur de chargement");const t=await s.json();L(t.config),$(t.conversions||[]),B(t.stats),D(t.today),U(t.user_points),f(t.config.min_conversion_points)}catch(s){console.error(s),g.error("Erreur lors du chargement")}finally{i(!1)}},R=async()=>{try{const s=await fetch(`${N}/shop/games.php`,{credentials:"include"});if(s.ok){const t=await s.json();K(t.games||[])}}catch(s){console.error("Erreur chargement jeux:",s)}},X=async()=>{if(y&&confirm(`Confirmer la conversion de ${d} points en ${p} minutes ?`))try{l(!0);const s=await fetch(`${N}/player/convert_points.php`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({points_to_convert:d,game_id:C})}),t=await s.json();if(!s.ok){g.error(t.error||"Erreur lors de la conversion");return}g.success(t.message,{description:`Nouveau solde: ${t.new_balance} points`}),await P(),f(n.min_conversion_points),v(null)}catch(s){console.error(s),g.error("Erreur lors de la conversion")}finally{l(!1)}},M=s=>{const t={active:{bg:"bg-green-100",text:"text-green-700",label:"Actif",icon:E},used:{bg:"bg-blue-100",text:"text-blue-700",label:"Utilisé",icon:E},expired:{bg:"bg-gray-100",text:"text-gray-700",label:"Expiré",icon:I},cancelled:{bg:"bg-red-100",text:"text-red-700",label:"Annulé",icon:I}};return t[s]||t.active},O=s=>new Date(s).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),h=s=>{const t=Math.floor(s/60),u=s%60;return t>0?`${t}h${u>0?` ${u}min`:""}`:`${u}min`};return x?e.jsx(r,{className:"min-h-screen bg-gradient-to-br from-purple-900 via-indigo-900 to-blue-900 flex items-center justify-center",renderId:"render-8a05ccd3",as:"div",children:e.jsx(r,{className:"animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-white",renderId:"render-9522f95a",as:"div"})}):!n||!n.is_active?e.jsxs(r,{className:"min-h-screen bg-gradient-to-br from-purple-900 via-indigo-900 to-blue-900",renderId:"render-f6ce645a",as:"div",children:[e.jsx(S,{userType:"player"}),e.jsx(r,{className:"container mx-auto px-4 py-8",renderId:"render-5b4504ad",as:"div",children:e.jsxs(r,{className:"bg-white rounded-xl p-12 text-center",renderId:"render-176cb3ff",as:"div",children:[e.jsx(I,{className:"w-24 h-24 text-gray-400 mx-auto mb-4"}),e.jsx(r,{className:"text-2xl font-bold text-gray-800 mb-2",renderId:"render-478700e1",as:"h2",children:"Système de Conversion Désactivé"}),e.jsx(r,{className:"text-gray-600",renderId:"render-f349fa51",as:"p",children:"Le système de conversion de points est temporairement désactivé."})]})})]}):e.jsxs(r,{className:"min-h-screen bg-gradient-to-br from-purple-900 via-indigo-900 to-blue-900",renderId:"render-702b239b",as:"div",children:[e.jsx(S,{userType:"player"}),e.jsxs(r,{className:"container mx-auto px-4 py-8",renderId:"render-78da3bb7",as:"div",children:[e.jsx(r,{className:"bg-white rounded-xl shadow-lg p-6 mb-6",renderId:"render-662df9e5",as:"div",children:e.jsxs(r,{className:"flex items-center justify-between",renderId:"render-0d5abf87",as:"div",children:[e.jsxs(r,{renderId:"render-9812b06f",as:"div",children:[e.jsxs(r,{className:"text-3xl font-bold text-purple-600 mb-2 flex items-center gap-3",renderId:"render-37f125da",as:"h1",children:[e.jsx(_,{className:"w-8 h-8"}),"Convertir Mes Points"]}),e.jsx(r,{className:"text-gray-600",renderId:"render-fdd7c767",as:"p",children:"Transformez vos points en temps de jeu"})]}),e.jsxs(r,{className:"text-right",renderId:"render-263daa37",as:"div",children:[e.jsx(r,{className:"text-sm text-gray-600",renderId:"render-6175b1cc",as:"div",children:"Solde actuel"}),e.jsxs(r,{className:"text-3xl font-bold text-purple-600 flex items-center gap-2",renderId:"render-19617c85",as:"div",children:[e.jsx(b,{className:"w-8 h-8"}),c.toLocaleString()," pts"]})]})]})}),e.jsxs(r,{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",renderId:"render-e168e4f7",as:"div",children:[e.jsxs(r,{className:"bg-white rounded-xl p-6 shadow-lg",renderId:"render-ac1d6667",as:"div",children:[e.jsxs(r,{className:"flex items-center justify-between mb-2",renderId:"render-26912694",as:"div",children:[e.jsx(A,{className:"w-8 h-8 text-blue-500"}),e.jsx(z,{className:"w-5 h-5 text-green-500"})]}),e.jsx(r,{className:"text-2xl font-bold text-gray-800",renderId:"render-9dae0f35",as:"div",children:h(j?.minutes_available||0)}),e.jsx(r,{className:"text-sm text-gray-600",renderId:"render-0be00914",as:"div",children:"Disponibles"})]}),e.jsxs(r,{className:"bg-white rounded-xl p-6 shadow-lg",renderId:"render-3179127c",as:"div",children:[e.jsx(r,{className:"flex items-center justify-between mb-2",renderId:"render-6b2ca0c7",as:"div",children:e.jsx(F,{className:"w-8 h-8 text-purple-500"})}),e.jsx(r,{className:"text-2xl font-bold text-gray-800",renderId:"render-83c4a7c2",as:"div",children:j?.total_conversions||0}),e.jsx(r,{className:"text-sm text-gray-600",renderId:"render-27226a3d",as:"div",children:"Conversions"})]}),e.jsxs(r,{className:"bg-white rounded-xl p-6 shadow-lg",renderId:"render-2ce213ad",as:"div",children:[e.jsx(r,{className:"flex items-center justify-between mb-2",renderId:"render-c6929b75",as:"div",children:e.jsx(b,{className:"w-8 h-8 text-yellow-500"})}),e.jsx(r,{className:"text-2xl font-bold text-gray-800",renderId:"render-8cc2e6a5",as:"div",children:j?.total_points_spent?.toLocaleString()||0}),e.jsx(r,{className:"text-sm text-gray-600",renderId:"render-38c349e3",as:"div",children:"Points Dépensés"})]}),e.jsxs(r,{className:"bg-white rounded-xl p-6 shadow-lg",renderId:"render-594a8448",as:"div",children:[e.jsx(r,{className:"flex items-center justify-between mb-2",renderId:"render-f6c24eae",as:"div",children:e.jsx(T,{className:"w-8 h-8 text-green-500"})}),e.jsxs(r,{className:"text-2xl font-bold text-gray-800",renderId:"render-1d2c5612",as:"div",children:[m?.conversions_count||0," / ",n.max_conversion_per_day||"∞"]}),e.jsx(r,{className:"text-sm text-gray-600",renderId:"render-6a987d78",as:"div",children:"Aujourd'hui"})]})]}),e.jsxs(r,{className:"bg-white rounded-xl shadow-lg p-8 mb-6",renderId:"render-c52c9335",as:"div",children:[e.jsxs(r,{className:"text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2",renderId:"render-4c84f847",as:"h2",children:[e.jsx(_,{className:"w-6 h-6 text-purple-600"}),"Nouvelle Conversion"]}),e.jsxs(r,{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6 flex items-start gap-3",renderId:"render-af6846a9",as:"div",children:[e.jsx(q,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),e.jsxs(r,{className:"text-sm text-blue-800",renderId:"render-1ea3d3ff",as:"div",children:[e.jsx(r,{renderId:"render-747fa259",as:"strong",children:"Taux de conversion:"})," ",n.points_per_minute," points = 1 minute de jeu",n.conversion_fee_percent>0&&e.jsxs(r,{renderId:"render-23289295",as:"span",children:[" (frais: ",n.conversion_fee_percent,"%)"]})]})]}),e.jsxs(r,{className:"mb-8",renderId:"render-dc6cbab7",as:"div",children:[e.jsx(r,{className:"block text-gray-700 font-semibold mb-3",renderId:"render-4df37961",as:"label",children:"Combien de points voulez-vous convertir ?"}),e.jsx(r,{className:"relative",renderId:"render-e0a00ce1",as:"div",children:e.jsx(r,{type:"range",min:n.min_conversion_points,max:Math.min(c,n.max_minutes?n.max_minutes*n.points_per_minute:c),step:n.points_per_minute,value:d,onChange:s=>f(parseInt(s.target.value)),className:"w-full h-3 bg-purple-200 rounded-lg appearance-none cursor-pointer accent-purple-600",renderId:"render-19052d50",as:"input"})}),e.jsxs(r,{className:"flex justify-between text-xs text-gray-500 mt-2",renderId:"render-74a5cabe",as:"div",children:[e.jsxs(r,{renderId:"render-c13ea274",as:"span",children:[n.min_conversion_points," pts"]}),e.jsxs(r,{renderId:"render-cb04e5d7",as:"span",children:[Math.min(c,n.max_minutes?n.max_minutes*n.points_per_minute:c)," pts"]})]})]}),e.jsx(r,{className:"bg-gradient-to-r from-purple-100 to-blue-100 rounded-xl p-6 mb-6",renderId:"render-ede58cea",as:"div",children:e.jsxs(r,{className:"flex items-center justify-between",renderId:"render-46902f7d",as:"div",children:[e.jsxs(r,{className:"text-center flex-1",renderId:"render-606b0299",as:"div",children:[e.jsx(r,{className:"text-4xl font-bold text-purple-600 mb-2",renderId:"render-4bd416e1",as:"div",children:d.toLocaleString()}),e.jsxs(r,{className:"text-gray-700 font-semibold flex items-center justify-center gap-2",renderId:"render-6a159238",as:"div",children:[e.jsx(b,{className:"w-5 h-5"}),"Points"]})]}),e.jsx(J,{className:"w-12 h-12 text-purple-600 mx-8"}),e.jsxs(r,{className:"text-center flex-1",renderId:"render-61437983",as:"div",children:[e.jsx(r,{className:"text-4xl font-bold text-blue-600 mb-2",renderId:"render-45d009c5",as:"div",children:p}),e.jsxs(r,{className:"text-gray-700 font-semibold flex items-center justify-center gap-2",renderId:"render-8365dfd5",as:"div",children:[e.jsx(A,{className:"w-5 h-5"}),h(p)]})]})]})}),e.jsxs(r,{className:"mb-6",renderId:"render-29665a33",as:"div",children:[e.jsx(r,{className:"block text-gray-700 font-semibold mb-3",renderId:"render-c7e391be",as:"label",children:"Choisir un jeu (optionnel)"}),e.jsxs(r,{value:C||"",onChange:s=>v(s.target.value?parseInt(s.target.value):null),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",renderId:"render-3e429d98",as:"select",children:[e.jsx(r,{value:"",renderId:"render-078fd9c6",as:"option",children:"Tous les jeux"}),k.filter(s=>s.is_active).map(s=>e.jsx(r,{value:s.id,renderId:"render-d6454056",as:"option",children:s.name},s.id))]})]}),e.jsxs(r,{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6 flex items-start gap-3",renderId:"render-05221f89",as:"div",children:[e.jsx(Z,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),e.jsxs(r,{className:"text-sm text-yellow-800",renderId:"render-70cc9004",as:"div",children:["Le temps converti expire dans ",e.jsxs(r,{renderId:"render-e30f9ab7",as:"strong",children:[n.expiry_days," jours"]}),". Utilisez-le avant expiration."]})]}),e.jsxs(r,{className:"flex gap-4",renderId:"render-3e99cdb0",as:"div",children:[e.jsx(r,{onClick:X,disabled:!y||o,className:"flex-1 px-6 py-4 bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-xl font-bold hover:from-purple-700 hover:to-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 shadow-lg transition-all",renderId:"render-47802a08",as:"button",children:o?e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"w-5 h-5 animate-spin"}),"Conversion en cours..."]}):e.jsxs(e.Fragment,{children:[e.jsx(_,{className:"w-5 h-5"}),"Convertir Maintenant"]})}),e.jsx(r,{onClick:()=>{f(n.min_conversion_points),v(null)},className:"px-6 py-4 bg-gray-200 text-gray-700 rounded-xl font-bold hover:bg-gray-300 transition-all",renderId:"render-62066c2f",as:"button",children:"Réinitialiser"})]}),!y&&d>0&&e.jsxs(r,{className:"mt-4 text-sm text-red-600",renderId:"render-dab4157e",as:"div",children:[d<n.min_conversion_points&&`Minimum ${n.min_conversion_points} points requis`,d>c&&`Points insuffisants (vous avez ${c} points)`,n.max_minutes&&p>n.max_minutes&&`Maximum ${n.max_minutes} minutes par conversion`,m&&n.max_conversion_per_day&&m.remaining_today===0&&`Limite quotidienne atteinte (${n.max_conversion_per_day} conversions/jour)`]})]}),e.jsxs(r,{className:"bg-white rounded-xl shadow-lg overflow-hidden",renderId:"render-13f34ba5",as:"div",children:[e.jsx(r,{className:"p-6 border-b",renderId:"render-d39fd99b",as:"div",children:e.jsxs(r,{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",renderId:"render-b61c6659",as:"h2",children:[e.jsx(T,{className:"w-6 h-6"}),"Historique des Conversions"]})}),w.length===0?e.jsxs(r,{className:"p-12 text-center",renderId:"render-03857ccc",as:"div",children:[e.jsx(b,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx(r,{className:"text-gray-600",renderId:"render-f9f9a060",as:"p",children:"Aucune conversion effectuée"})]}):e.jsx(r,{className:"overflow-x-auto",renderId:"render-7932a011",as:"div",children:e.jsxs(r,{className:"w-full",renderId:"render-3967208e",as:"table",children:[e.jsx(r,{className:"bg-gray-50",renderId:"render-57982f42",as:"thead",children:e.jsxs(r,{renderId:"render-b9a36c02",as:"tr",children:[e.jsx(r,{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase",renderId:"render-bcd0c296",as:"th",children:"Date"}),e.jsx(r,{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase",renderId:"render-a9f84b90",as:"th",children:"Points"}),e.jsx(r,{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase",renderId:"render-d75feb42",as:"th",children:"Temps"}),e.jsx(r,{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase",renderId:"render-9a1366b7",as:"th",children:"Jeu"}),e.jsx(r,{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase",renderId:"render-8db70e45",as:"th",children:"Statut"}),e.jsx(r,{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase",renderId:"render-e9c674c2",as:"th",children:"Expire le"})]})}),e.jsx(r,{className:"divide-y divide-gray-200",renderId:"render-60f21035",as:"tbody",children:w.map(s=>{const t=M(s.status),u=t.icon;return e.jsxs(r,{className:"hover:bg-gray-50",renderId:"render-5c84ae40",as:"tr",children:[e.jsx(r,{className:"px-6 py-4 text-sm text-gray-900",renderId:"render-7ab22150",as:"td",children:O(s.created_at)}),e.jsxs(r,{className:"px-6 py-4 text-sm font-semibold text-purple-600",renderId:"render-f2311b54",as:"td",children:[s.points_spent," pts"]}),e.jsxs(r,{className:"px-6 py-4 text-sm font-semibold text-blue-600",renderId:"render-0f7ce97c",as:"td",children:[h(s.minutes_gained),s.minutes_used>0&&e.jsxs(r,{className:"text-gray-500 ml-2",renderId:"render-9548a1a3",as:"span",children:["(utilisé: ",h(s.minutes_used),")"]})]}),e.jsx(r,{className:"px-6 py-4 text-sm text-gray-700",renderId:"render-cbb9fb40",as:"td",children:s.game_name||"Tous les jeux"}),e.jsx(r,{className:"px-6 py-4",renderId:"render-09001681",as:"td",children:e.jsxs(r,{className:`px-3 py-1 rounded-full text-xs font-semibold ${t.bg} ${t.text} flex items-center gap-1 w-fit`,renderId:"render-c7c2e3a1",as:"span",children:[e.jsx(u,{className:"w-3 h-3"}),t.label]})}),e.jsx(r,{className:"px-6 py-4 text-sm text-gray-600",renderId:"render-22728fdd",as:"td",children:new Date(s.expires_at).toLocaleDateString("fr-FR")})]},s.id)})})]})})]})]})]})}if(typeof window<"u"){const x={NEXT_PUBLIC_API_BASE:"https://votre-domaine.infinityfreeapp.com/api",NEXT_PUBLIC_KKIAPAY_PUBLIC_KEY:"072b361d25546db0aee3d69bf07b15331c51e39f",NEXT_PUBLIC_KKIAPAY_SANDBOX:"0"};globalThis.process??={};const i=globalThis.process.env??{};globalThis.process.env=new Proxy(Object.assign({},x,i),{get(o,l){return l in o?o[l]:void 0},has(){return!0}})}const Ie=Y(function(i){return e.jsx(G,{children:e.jsx(W,{...i})})});export{Ie as default};
