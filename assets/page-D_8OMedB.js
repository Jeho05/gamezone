import{r as p,i as N}from"./react-vendor-DYp0RFF0.js";import{j as e}from"./ui-vendor-DAbCkwHz.js";import{R as w}from"./layout-BhjoAR2P.js";import{C as r}from"./PolymorphicComponent-kLkD8TKY.js";import{t as o}from"./index-ISQCChad.js";import{N as y}from"./Navigation-KwyceX57.js";import{A as b}from"./apiBase-uKT1-15E.js";import"./index-Birp5Yjg.js";import"./gamepad-DUfdRHsM.js";import"./createLucideIcon-BuqtEc0O.js";import"./users-CFhMAaaJ.js";import"./star-COodYRQY.js";import"./sparkles-CYj8vm4n.js";import"./trophy-i2KwZb7z.js";import"./x-B8NaV6qa.js";if(typeof window<"u"){const s={NEXT_PUBLIC_API_BASE:"https://votre-domaine.infinityfreeapp.com/api",NEXT_PUBLIC_KKIAPAY_PUBLIC_KEY:"072b361d25546db0aee3d69bf07b15331c51e39f",NEXT_PUBLIC_KKIAPAY_SANDBOX:"0"};globalThis.process??={};const i=globalThis.process.env??{};globalThis.process.env=new Proxy(Object.assign({},s,i),{get(c,u){return u in c?c[u]:void 0},has(){return!0}})}function C(){const[s,i]=p.useState([]),[c,u]=p.useState([]),[d,t]=p.useState(!0),[x,n]=p.useState(!1),[j,m]=p.useState(null),I=async()=>{try{const l=await(await fetch(`${b}/admin/games.php`,{credentials:"include"})).json();console.log("Jeux chargés:",l.games),u(l.games||[]),(!l.games||l.games.length===0)&&o.info("Aucun jeu disponible. Créez-en un d'abord.")}catch(a){console.error("Erreur chargement jeux:",a),o.error("Impossible de charger les jeux")}},g=async()=>{try{const l=await(await fetch(`${b}/admin/rewards.php`,{credentials:"include"})).json();i(l.rewards||[])}catch{o.error("Erreur lors du chargement")}finally{t(!1)}};p.useEffect(()=>{I(),g()},[]);const v=async a=>{try{console.log("Tentative de sauvegarde:",a);const l=a.id?"PUT":"POST",h=await fetch(`${b}/admin/rewards.php`,{method:l,headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(a)}),f=await h.json();if(!h.ok)throw console.error("Erreur serveur:",f),new Error(f.error||"Erreur lors de la sauvegarde");o.success(a.id?"Récompense mise à jour":"Récompense créée avec succès"),await g(),n(!1),m(null)}catch(l){console.error("Erreur complète:",l),o.error("Erreur: "+l.message)}},_=async a=>{if(confirm("Supprimer cette récompense ?"))try{if(!(await fetch(`${b}/admin/rewards.php`,{method:"DELETE",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({id:a})})).ok)throw new Error("Delete failed");o.success("Récompense supprimée"),g()}catch(l){console.error("Delete error:",l),o.error("Erreur lors de la suppression")}};return d?e.jsxs(r,{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900",renderId:"render-f10926d7",as:"div",children:[e.jsx(y,{userType:"admin",currentPage:"rewards"}),e.jsx(r,{className:"lg:pl-64",renderId:"render-45bec82f",as:"div",children:e.jsx(r,{className:"flex items-center justify-center min-h-screen",renderId:"render-a0c297dc",as:"div",children:e.jsx(r,{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-purple-500",renderId:"render-31de7bc2",as:"div"})})})]}):e.jsxs(r,{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900",renderId:"render-dde0701a",as:"div",children:[e.jsx(y,{userType:"admin",currentPage:"rewards"}),e.jsx(r,{className:"lg:pl-64",renderId:"render-49501248",as:"div",children:e.jsx(r,{className:"p-4 lg:p-8",renderId:"render-37eeb0fb",as:"div",children:e.jsxs(r,{className:"max-w-6xl mx-auto",renderId:"render-c0c05766",as:"div",children:[e.jsxs(r,{className:"mb-8 flex items-center justify-between",renderId:"render-2c111b8d",as:"div",children:[e.jsxs(r,{renderId:"render-01d5c556",as:"div",children:[e.jsx(r,{className:"text-4xl font-bold mb-2 bg-gradient-to-r from-cyan-400 to-blue-500 text-transparent bg-clip-text",renderId:"render-05f1e4d5",as:"h1",children:"🎁 Gestion des Récompenses"}),e.jsx(r,{className:"text-gray-400",renderId:"render-4cc84859",as:"p",children:"Gérez le catalogue de récompenses échangeables"})]}),e.jsx(r,{onClick:()=>{m(null),n(!0)},className:"px-6 py-3 bg-gradient-to-r from-cyan-500 to-blue-500 rounded-lg font-bold hover:shadow-lg transition-all",renderId:"render-116ba50e",as:"button",children:"+ Nouvelle récompense"})]}),e.jsx(r,{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",renderId:"render-970c4527",as:"div",children:s.map(a=>e.jsxs(r,{className:`bg-gray-800 rounded-lg p-6 border-2 ${a.available?"border-cyan-500/50":"border-gray-700"}`,renderId:"render-3d2faab6",as:"div",children:[e.jsx(r,{className:"flex items-start justify-between mb-4",renderId:"render-f491300c",as:"div",children:e.jsxs(r,{className:"flex-1",renderId:"render-50235970",as:"div",children:[e.jsx(r,{className:"text-lg font-bold text-white mb-2",renderId:"render-a1307464",as:"h3",children:a.name}),!a.available&&e.jsx(r,{className:"inline-block px-2 py-1 bg-red-500/20 text-red-400 text-xs rounded-full mb-2",renderId:"render-7ef0fcfc",as:"span",children:"Indisponible"})]})}),e.jsxs(r,{className:"mb-4",renderId:"render-d424039e",as:"div",children:[e.jsx(r,{className:"text-3xl font-bold text-cyan-400",renderId:"render-11df81a7",as:"p",children:a.cost}),e.jsx(r,{className:"text-xs text-gray-500",renderId:"render-0711ddda",as:"p",children:"points"}),a.reward_type&&e.jsx(r,{className:"inline-block mt-2 px-2 py-1 bg-purple-500/20 text-purple-300 text-xs rounded-full",renderId:"render-e6755ea9",as:"span",children:a.reward_type==="game_package"?"🎮 Package Jeu":a.reward_type==="game_time"?"⏱️ Temps":a.reward_type==="physical"?"🎁 Physique":a.reward_type})]}),e.jsxs(r,{className:"flex gap-2",renderId:"render-786aab8c",as:"div",children:[e.jsx(r,{onClick:()=>{m(a),n(!0)},className:"flex-1 px-4 py-2 bg-blue-500/20 text-blue-400 rounded hover:bg-blue-500/30 transition-all",renderId:"render-982bc251",as:"button",children:"Modifier"}),e.jsx(r,{onClick:()=>_(a.id),className:"flex-1 px-4 py-2 bg-red-500/20 text-red-400 rounded hover:bg-red-500/30 transition-all",renderId:"render-5d60b340",as:"button",children:"Supprimer"})]})]},a.id))}),x&&e.jsx(k,{reward:j,games:c,onSave:v,onClose:()=>{n(!1),m(null)}})]})})})]})}function k({reward:s,games:i,onSave:c,onClose:u}){const[d,t]=p.useState({id:s?.id||0,name:s?.name||"",description:s?.description||"",cost:s?.cost||0,category:s?.category||"",reward_type:s?.reward_type||"physical",game_time_minutes:s?.game_time_minutes||0,available:s?.available!==void 0?s.available:1,game_id:s?.game_id||"",duration_minutes:s?.duration_minutes||30,points_earned:s?.points_earned||0,bonus_multiplier:s?.bonus_multiplier||1,max_per_user:s?.max_purchases_per_user||"",is_promotional:s?.is_promotional||0,promotional_label:s?.promotional_label||"",is_featured:s?.is_featured||0,display_order:s?.display_order||0}),x=n=>{if(n.preventDefault(),!d.name||d.cost<0){o.error("Veuillez remplir tous les champs requis");return}if(d.reward_type==="game_time"&&d.game_time_minutes<=0){o.error("Veuillez spécifier le nombre de minutes de jeu");return}if(d.reward_type==="game_package"){if(!d.game_id){o.error("Veuillez sélectionner un jeu");return}if(d.duration_minutes<=0){o.error("Veuillez spécifier la durée en minutes");return}if(d.points_earned<0){o.error("Les points gagnés doivent être positifs");return}}c(d)};return e.jsx(r,{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",renderId:"render-547828b6",as:"div",children:e.jsxs(r,{className:`bg-gray-800 rounded-lg ${d.reward_type==="game_package"?"max-w-2xl":"max-w-md"} w-full border-2 border-cyan-500/50 max-h-[90vh] flex flex-col`,renderId:"render-3b9e6a16",as:"div",children:[e.jsx(r,{className:"p-6 border-b border-gray-700",renderId:"render-5db0472f",as:"div",children:e.jsxs(r,{className:"text-2xl font-bold text-cyan-400",renderId:"render-d488c9f5",as:"h2",children:[s?"Modifier":"Nouvelle"," Récompense"]})}),e.jsx(r,{className:"flex-1 overflow-y-auto p-6",renderId:"render-54581d44",as:"div",children:e.jsxs(r,{id:"reward-form",onSubmit:x,className:"space-y-4",renderId:"render-4ccb81a2",as:"form",children:[e.jsxs(r,{renderId:"render-fc16c71c",as:"div",children:[e.jsx(r,{className:"block text-sm font-bold text-gray-400 mb-2",renderId:"render-dd88f95a",as:"label",children:"Nom de la récompense *"}),e.jsx(r,{type:"text",value:d.name,onChange:n=>t({...d,name:n.target.value}),className:"w-full px-4 py-2 bg-gray-700 rounded border border-gray-600 text-white focus:border-cyan-500 focus:outline-none",placeholder:"Ex: 1h de jeu gratuite",required:!0,renderId:"render-a3ef9a60",as:"input"})]}),e.jsxs(r,{renderId:"render-328d33ef",as:"div",children:[e.jsx(r,{className:"block text-sm font-bold text-gray-400 mb-2",renderId:"render-bb1b47c1",as:"label",children:"Description"}),e.jsx(r,{value:d.description,onChange:n=>t({...d,description:n.target.value}),className:"w-full px-4 py-2 bg-gray-700 rounded border border-gray-600 text-white focus:border-cyan-500 focus:outline-none",placeholder:"Description de la récompense",rows:"3",renderId:"render-75271358",as:"textarea"})]}),e.jsxs(r,{renderId:"render-67f5b7a6",as:"div",children:[e.jsx(r,{className:"block text-sm font-bold text-gray-400 mb-2",renderId:"render-ff368cd0",as:"label",children:"Type de récompense *"}),e.jsxs(r,{value:d.reward_type,onChange:n=>t({...d,reward_type:n.target.value}),className:"w-full px-4 py-2 bg-gray-700 rounded border border-gray-600 text-white focus:border-cyan-500 focus:outline-none",renderId:"render-acec01f3",as:"select",children:[e.jsx(r,{value:"physical",renderId:"render-c77f6a1d",as:"option",children:"🎁 Physique"}),e.jsx(r,{value:"game_package",renderId:"render-4d94c1f0",as:"option",children:"🎮 Package de Jeu"}),e.jsx(r,{value:"game_time",renderId:"render-f53b0ea1",as:"option",children:"⏱️ Temps de jeu"}),e.jsx(r,{value:"discount",renderId:"render-d57d453a",as:"option",children:"🏷️ Réduction"}),e.jsx(r,{value:"item",renderId:"render-3d2802a2",as:"option",children:"🎉 Objet/Cadeau"}),e.jsx(r,{value:"badge",renderId:"render-02a673ac",as:"option",children:"🏆 Badge"})]})]}),d.reward_type==="game_time"&&e.jsxs(r,{className:"bg-cyan-500/10 border border-cyan-500/30 rounded p-4",renderId:"render-535d39c8",as:"div",children:[e.jsx(r,{className:"block text-sm font-bold text-cyan-400 mb-2",renderId:"render-99375c2c",as:"label",children:"⏱️ Temps de jeu (en minutes) *"}),e.jsx(r,{type:"number",value:d.game_time_minutes,onChange:n=>t({...d,game_time_minutes:parseInt(n.target.value)||0}),className:"w-full px-4 py-2 bg-gray-700 rounded border border-cyan-500 text-white focus:border-cyan-400 focus:outline-none",min:"0",placeholder:"Ex: 60 pour 1 heure",renderId:"render-60db6012",as:"input"}),e.jsx(r,{className:"text-xs text-cyan-300 mt-2",renderId:"render-34422a30",as:"p",children:"Les minutes seront ajoutées au crédit de temps de jeu de l'utilisateur lors de l'échange"})]}),d.reward_type==="game_package"&&e.jsxs(r,{className:"bg-purple-500/10 border border-purple-500/30 rounded p-4 space-y-4",renderId:"render-9fe686f5",as:"div",children:[e.jsx(r,{className:"bg-blue-900/30 border border-blue-500/30 rounded p-3",renderId:"render-5a10e0e5",as:"div",children:e.jsxs(r,{className:"text-sm text-blue-300",renderId:"render-08995b62",as:"p",children:["🎮 ",e.jsx(r,{renderId:"render-2f217f9f",as:"strong",children:"Package de Jeu:"})," Créera automatiquement un package de jeu échangeable uniquement contre des points."]})}),e.jsxs(r,{renderId:"render-5ac66192",as:"div",children:[e.jsx(r,{className:"block text-sm font-bold text-purple-400 mb-2",renderId:"render-be55d65e",as:"label",children:"Sélectionner un jeu *"}),e.jsxs(r,{value:d.game_id,onChange:n=>t({...d,game_id:parseInt(n.target.value)}),className:"w-full px-4 py-2 bg-gray-700 rounded border border-purple-500 text-white focus:border-purple-400 focus:outline-none",required:!0,renderId:"render-68560213",as:"select",children:[e.jsx(r,{value:"",renderId:"render-d402e4ef",as:"option",children:i.length===0?"⏳ Chargement des jeux...":"-- Choisir un jeu --"}),i.map(n=>e.jsxs(r,{value:n.id,renderId:"render-58bb4eb8",as:"option",children:[n.name," (",n.category,")"]},n.id))]}),i.length===0&&e.jsx(r,{className:"text-xs text-yellow-400 mt-2",renderId:"render-923c606e",as:"p",children:`⚠️ Aucun jeu disponible. Créez d'abord un jeu dans la section "Jeux".`})]}),e.jsxs(r,{className:"grid grid-cols-2 gap-3",renderId:"render-9fb2787d",as:"div",children:[e.jsxs(r,{renderId:"render-099d7c1b",as:"div",children:[e.jsx(r,{className:"block text-sm font-bold text-purple-400 mb-2",renderId:"render-015e6534",as:"label",children:"Durée (minutes) *"}),e.jsx(r,{type:"number",value:d.duration_minutes,onChange:n=>t({...d,duration_minutes:parseInt(n.target.value)||0}),className:"w-full px-4 py-2 bg-gray-700 rounded border border-purple-500 text-white focus:border-purple-400 focus:outline-none",min:"5",step:"5",placeholder:"Ex: 30",renderId:"render-d057399a",as:"input"})]}),e.jsxs(r,{renderId:"render-a0700557",as:"div",children:[e.jsx(r,{className:"block text-sm font-bold text-purple-400 mb-2",renderId:"render-fbc22e54",as:"label",children:"Points bonus *"}),e.jsx(r,{type:"number",value:d.points_earned,onChange:n=>t({...d,points_earned:parseInt(n.target.value)||0}),className:"w-full px-4 py-2 bg-gray-700 rounded border border-purple-500 text-white focus:border-purple-400 focus:outline-none",min:"0",placeholder:"Ex: 10",renderId:"render-0447d121",as:"input"})]})]}),e.jsxs(r,{className:"grid grid-cols-2 gap-3",renderId:"render-e782c7ae",as:"div",children:[e.jsxs(r,{renderId:"render-db00dd82",as:"div",children:[e.jsx(r,{className:"block text-sm font-bold text-purple-400 mb-2",renderId:"render-b9a55610",as:"label",children:"Multiplicateur bonus"}),e.jsx(r,{type:"number",value:d.bonus_multiplier,onChange:n=>t({...d,bonus_multiplier:parseFloat(n.target.value)||1}),className:"w-full px-4 py-2 bg-gray-700 rounded border border-purple-500 text-white focus:border-purple-400 focus:outline-none",min:"1",max:"5",step:"0.1",renderId:"render-4f6ec834",as:"input"})]}),e.jsxs(r,{renderId:"render-351a7046",as:"div",children:[e.jsx(r,{className:"block text-sm font-bold text-purple-400 mb-2",renderId:"render-c81e6af1",as:"label",children:"Max achats/utilisateur"}),e.jsx(r,{type:"number",value:d.max_per_user,onChange:n=>t({...d,max_per_user:n.target.value}),className:"w-full px-4 py-2 bg-gray-700 rounded border border-purple-500 text-white focus:border-purple-400 focus:outline-none",min:"1",placeholder:"Vide = illimité",renderId:"render-d10a36fa",as:"input"})]})]}),e.jsx(r,{renderId:"render-80c13979",as:"div",children:e.jsxs(r,{className:"flex items-center gap-2 cursor-pointer",renderId:"render-f239f41b",as:"label",children:[e.jsx(r,{type:"checkbox",checked:d.is_promotional,onChange:n=>t({...d,is_promotional:n.target.checked?1:0}),className:"w-5 h-5",renderId:"render-3dc2e1d1",as:"input"}),e.jsx(r,{className:"text-sm text-purple-300",renderId:"render-d19eebe7",as:"span",children:"🔥 Package promotionnel"})]})}),d.is_promotional===1&&e.jsxs(r,{renderId:"render-8a4050a6",as:"div",children:[e.jsx(r,{className:"block text-sm font-bold text-purple-400 mb-2",renderId:"render-319f5628",as:"label",children:"Label promotionnel"}),e.jsx(r,{type:"text",value:d.promotional_label,onChange:n=>t({...d,promotional_label:n.target.value}),className:"w-full px-4 py-2 bg-gray-700 rounded border border-purple-500 text-white focus:border-purple-400 focus:outline-none",placeholder:"Ex: -20%, PROMO, NOUVEAU",renderId:"render-03c865d2",as:"input"})]}),e.jsx(r,{renderId:"render-c346882a",as:"div",children:e.jsxs(r,{className:"flex items-center gap-2 cursor-pointer",renderId:"render-4e7ae6b3",as:"label",children:[e.jsx(r,{type:"checkbox",checked:d.is_featured,onChange:n=>t({...d,is_featured:n.target.checked?1:0}),className:"w-5 h-5",renderId:"render-d3909c3d",as:"input"}),e.jsx(r,{className:"text-sm text-purple-300",renderId:"render-9bde5db7",as:"span",children:"⭐ Mettre en vedette"})]})})]}),e.jsxs(r,{renderId:"render-d1194856",as:"div",children:[e.jsx(r,{className:"block text-sm font-bold text-gray-400 mb-2",renderId:"render-9bf8f544",as:"label",children:"Catégorie"}),e.jsx(r,{type:"text",value:d.category,onChange:n=>t({...d,category:n.target.value}),className:"w-full px-4 py-2 bg-gray-700 rounded border border-gray-600 text-white focus:border-cyan-500 focus:outline-none",placeholder:"Ex: gaming, cosmetic",renderId:"render-765d9351",as:"input"})]}),e.jsxs(r,{renderId:"render-175fe981",as:"div",children:[e.jsx(r,{className:"block text-sm font-bold text-gray-400 mb-2",renderId:"render-5826646f",as:"label",children:"Coût en points *"}),e.jsx(r,{type:"number",value:d.cost,onChange:n=>t({...d,cost:parseInt(n.target.value)||0}),className:"w-full px-4 py-2 bg-gray-700 rounded border border-gray-600 text-white focus:border-cyan-500 focus:outline-none",min:"0",required:!0,renderId:"render-004e5c01",as:"input"})]}),e.jsx(r,{renderId:"render-cbc9748f",as:"div",children:e.jsxs(r,{className:"flex items-center gap-2 cursor-pointer",renderId:"render-48dd886e",as:"label",children:[e.jsx(r,{type:"checkbox",checked:d.available,onChange:n=>t({...d,available:n.target.checked?1:0}),className:"w-5 h-5",renderId:"render-efcdb962",as:"input"}),e.jsx(r,{className:"text-sm text-gray-400",renderId:"render-6fc7a603",as:"span",children:"Disponible à l'échange"})]})})]})}),e.jsx(r,{className:"p-6 border-t border-gray-700 bg-gray-800",renderId:"render-0fa29521",as:"div",children:e.jsxs(r,{className:"flex gap-3",renderId:"render-0ef690ac",as:"div",children:[e.jsx(r,{type:"button",onClick:u,className:"flex-1 px-4 py-3 bg-gray-700 rounded font-bold hover:bg-gray-600 transition-all",renderId:"render-d79fe39c",as:"button",children:"Annuler"}),e.jsx(r,{type:"submit",form:"reward-form",className:"flex-1 px-4 py-3 bg-gradient-to-r from-cyan-500 to-blue-500 rounded font-bold hover:shadow-lg transition-all",renderId:"render-21371c1e",as:"button",children:"Sauvegarder"})]})})]})})}if(typeof window<"u"){const s={NEXT_PUBLIC_API_BASE:"https://votre-domaine.infinityfreeapp.com/api",NEXT_PUBLIC_KKIAPAY_PUBLIC_KEY:"072b361d25546db0aee3d69bf07b15331c51e39f",NEXT_PUBLIC_KKIAPAY_SANDBOX:"0"};globalThis.process??={};const i=globalThis.process.env??{};globalThis.process.env=new Proxy(Object.assign({},s,i),{get(c,u){return u in c?c[u]:void 0},has(){return!0}})}const X=N(function(i){return e.jsx(w,{children:e.jsx(C,{...i})})});export{X as default};
