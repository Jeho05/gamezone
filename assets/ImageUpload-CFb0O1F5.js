import{C as a}from"./PolymorphicComponent-CmmJTj6d.js";import{r as u}from"./react-vendor-BXH1ZKCn.js";import{A as E}from"./apiBase-uKT1-15E.js";import{t as i}from"./index-DeIfEMOZ.js";import{j as e}from"./ui-vendor-CptTL0WJ.js";import{L as I}from"./loader-oMwspFKK.js";import{X as A}from"./x-BQPNjVqT.js";import{U}from"./upload-DUPv6M87.js";import{I as _}from"./image-BfDgDxRz.js";if(typeof window<"u"){const t={NEXT_PUBLIC_API_BASE:"https://votre-domaine.infinityfreeapp.com/api",NEXT_PUBLIC_KKIAPAY_PUBLIC_KEY:"072b361d25546db0aee3d69bf07b15331c51e39f",NEXT_PUBLIC_KKIAPAY_SANDBOX:"0"};globalThis.process??={};const d=globalThis.process.env??{};globalThis.process.env=new Proxy(Object.assign({},t,d),{get(c,l){return l in c?c[l]:void 0},has(){return!0}})}function O({value:t,onChange:d,label:c="Image"}){const[l,g]=u.useState(!1),[f,h]=u.useState(!1),[x,n]=u.useState(t||""),p=u.useRef(null),v=r=>{r.preventDefault(),r.stopPropagation(),g(!0)},j=r=>{r.preventDefault(),r.stopPropagation(),g(!1)},N=r=>{r.preventDefault(),r.stopPropagation()},y=r=>{r.preventDefault(),r.stopPropagation(),g(!1);const s=r.dataTransfer.files;s&&s.length>0&&b(s[0])},w=r=>{const s=r.target.files;s&&s.length>0&&b(s[0])},b=async r=>{if(!r.type.startsWith("image/")){i.error("Veuillez sélectionner une image valide");return}if(r.size>5*1024*1024){i.error("Image trop volumineuse. Taille max: 5MB");return}const s=new FileReader;s.onload=o=>{n(o.target.result)},s.readAsDataURL(r);try{h(!0);const o=new FormData;o.append("image",r);const m=await(await fetch(`${E}/admin/upload_image.php`,{method:"POST",credentials:"include",body:o})).json();m.success?(n(m.url),d(m.url),i.success("Image uploadée avec succès !")):(i.error(m.error||"Erreur lors de l'upload"),n(t||""))}catch(o){console.error("Upload error:",o),i.error("Erreur lors de l'upload de l'image"),n(t||"")}finally{h(!1)}},D=()=>{n(""),d(""),p.current&&(p.current.value="")},P=()=>{p.current?.click()};return e.jsxs(a,{className:"w-full",renderId:"render-8edeb085",as:"div",children:[e.jsx(a,{className:"block text-sm font-semibold mb-2",renderId:"render-4724d2df",as:"label",children:c}),x?e.jsxs(a,{className:"relative group",renderId:"render-786a83bb",as:"div",children:[e.jsx(a,{src:x,alt:"Aperçu",className:"w-full h-48 object-cover rounded-lg border-2 border-gray-300",renderId:"render-1ba3be27",as:"img"}),f&&e.jsx(a,{className:"absolute inset-0 bg-black/50 rounded-lg flex items-center justify-center",renderId:"render-259e3496",as:"div",children:e.jsx(I,{className:"w-8 h-8 text-white animate-spin"})}),e.jsx(a,{type:"button",onClick:D,className:"absolute top-2 right-2 bg-red-500 text-white p-2 rounded-full hover:bg-red-600 opacity-0 group-hover:opacity-100 transition-opacity",renderId:"render-4f8b027a",as:"button",children:e.jsx(A,{className:"w-4 h-4"})})]}):e.jsxs(a,{onClick:P,onDragEnter:v,onDragOver:N,onDragLeave:j,onDrop:y,className:`
            relative border-2 border-dashed rounded-lg p-8 text-center cursor-pointer
            transition-all duration-200
            ${l?"border-purple-500 bg-purple-50":"border-gray-300 hover:border-purple-400 hover:bg-gray-50"}
            ${f?"pointer-events-none opacity-50":""}
          `,renderId:"render-ca41af6e",as:"div",children:[e.jsx(a,{ref:p,type:"file",accept:"image/*",onChange:w,className:"hidden",renderId:"render-ca4142bb",as:"input"}),f?e.jsxs(a,{className:"flex flex-col items-center gap-3",renderId:"render-ed164909",as:"div",children:[e.jsx(I,{className:"w-12 h-12 text-purple-500 animate-spin"}),e.jsx(a,{className:"text-sm text-gray-600",renderId:"render-9d4f79d6",as:"p",children:"Upload en cours..."})]}):e.jsx(a,{className:"flex flex-col items-center gap-3",renderId:"render-37822710",as:"div",children:l?e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"w-12 h-12 text-purple-500"}),e.jsx(a,{className:"text-sm font-semibold text-purple-600",renderId:"render-a627eb0e",as:"p",children:"Déposez l'image ici"})]}):e.jsxs(e.Fragment,{children:[e.jsx(_,{className:"w-12 h-12 text-gray-400"}),e.jsxs(a,{className:"space-y-1",renderId:"render-49951ba7",as:"div",children:[e.jsx(a,{className:"text-sm font-semibold text-gray-700",renderId:"render-957abd42",as:"p",children:"Glissez-déposez une image ici"}),e.jsx(a,{className:"text-xs text-gray-500",renderId:"render-3e2e6de4",as:"p",children:"ou cliquez pour sélectionner"})]}),e.jsx(a,{className:"text-xs text-gray-400 mt-2",renderId:"render-972bce4b",as:"p",children:"JPG, PNG, GIF, WEBP • Max 5MB"})]})})]}),!x&&e.jsxs(a,{className:"mt-3",renderId:"render-62f6a9b9",as:"div",children:[e.jsx(a,{className:"text-xs text-gray-500 text-center mb-2",renderId:"render-43be7f3f",as:"div",children:"ou"}),e.jsx(a,{type:"url",placeholder:"Entrez une URL d'image",value:t||"",onChange:r=>{d(r.target.value),n(r.target.value)},className:"w-full px-3 py-2 text-sm border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",renderId:"render-71cc4e74",as:"input"})]})]})}export{O as I};
