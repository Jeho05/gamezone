import{u as R,r as o,w as F}from"./react-vendor-BXH1ZKCn.js";import{j as e}from"./ui-vendor-CptTL0WJ.js";import{R as D}from"./layout-CA9ilw8C.js";import{C as r}from"./PolymorphicComponent-CmmJTj6d.js";import{N as L,C as U,Q as X}from"./Navigation-C_UvFhfu.js";import{R as j,D as K,I as $}from"./InvoiceModal-Bp_S24M-.js";import{A as I}from"./apiBase-uKT1-15E.js";import{t as N}from"./index-DeIfEMOZ.js";import{F as k}from"./filter-BlspYazV.js";import{R as Q}from"./refresh-cw-BpUP_ghM.js";import{G as M}from"./gamepad-2-BnShYRR0.js";import{T as O}from"./timer-BY6tV2TF.js";import{C as v}from"./clock-BTYTED3i.js";import{C as Y}from"./circle-alert-BXr9mOHk.js";import{C as p}from"./circle-check-big-BJ9Fwu26.js";import{C as y}from"./circle-x-CzvvR37n.js";import"./gamepad-D9JnDti4.js";import"./createLucideIcon-BCGXG0XW.js";import"./users-uhOgvxGK.js";import"./sparkles-BFQn3fMP.js";import"./trophy-CUmIdvP5.js";import"./x-BQPNjVqT.js";if(typeof window<"u"){const c={NEXT_PUBLIC_API_BASE:"https://votre-domaine.infinityfreeapp.com/api",NEXT_PUBLIC_KKIAPAY_PUBLIC_KEY:"072b361d25546db0aee3d69bf07b15331c51e39f",NEXT_PUBLIC_KKIAPAY_SANDBOX:"0"};globalThis.process??={};const d=globalThis.process.env??{};globalThis.process.env=new Proxy(Object.assign({},c,d),{get(l,t){return t in l?l[t]:void 0},has(){return!0}})}function z(){const c=R(),[d,l]=o.useState([]),[t,w]=o.useState({}),[_,u]=o.useState(!0),[x,C]=o.useState(""),[b,f]=o.useState(null),[A,h]=o.useState(!1);o.useEffect(()=>{g()},[x]);const g=async()=>{try{u(!0);const s=x?`${I}/invoices/my_invoices.php?status=${x}`:`${I}/invoices/my_invoices.php`,n=await(await fetch(s,{credentials:"include"})).json();if(n.error){N.error(n.error);return}n.invoices&&(l(n.invoices),w(n.stats||{}))}catch(s){console.error(s),N.error("Erreur lors du chargement")}finally{u(!1)}},E=s=>{f(s),h(!0)},S=s=>{const a={pending:{icon:v,className:"bg-yellow-100 text-yellow-700",label:"En Attente",description:"Présentez cette facture à la réception"},active:{icon:p,className:"bg-green-100 text-green-700",label:"Active",description:"Session prête à démarrer"},used:{icon:p,className:"bg-blue-100 text-blue-700",label:"Utilisée",description:"Session terminée"},expired:{icon:y,className:"bg-red-100 text-red-700",label:"Expirée",description:"Facture expirée (2 mois)"},cancelled:{icon:y,className:"bg-gray-100 text-gray-700",label:"Annulée",description:"Facture annulée"}};return a[s]||a.pending},P=s=>new Date(s).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}),T=s=>{const m=new Date(s)-new Date,i=Math.floor(m/(1e3*60*60*24));return i<0?"Expirée":i===0?"Expire aujourd'hui":i===1?"Expire demain":`Expire dans ${i} jours`},B=[{value:"",label:"Toutes"},{value:"pending",label:"En Attente"},{value:"active",label:"Actives"},{value:"used",label:"Utilisées"},{value:"expired",label:"Expirées"}];return e.jsxs(r,{className:"min-h-screen bg-gradient-to-br from-purple-900 via-indigo-900 to-blue-900",renderId:"render-ed200d46",as:"div",children:[e.jsx(L,{userType:"player"}),e.jsx(r,{className:"lg:pl-64",renderId:"render-4f283ce3",as:"div",children:e.jsxs(r,{className:"container mx-auto px-4 py-8",renderId:"render-bb673513",as:"div",children:[e.jsxs(r,{className:"mb-8",renderId:"render-3672b0fb",as:"div",children:[e.jsxs(r,{className:"text-4xl font-bold text-white mb-2 flex items-center gap-3",renderId:"render-fd110944",as:"h1",children:[e.jsx(j,{className:"w-10 h-10"}),"Mes Factures"]}),e.jsx(r,{className:"text-gray-300",renderId:"render-70d37def",as:"p",children:"Consultez vos factures et codes QR"})]}),e.jsxs(r,{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",renderId:"render-570ec6ec",as:"div",children:[e.jsxs(r,{className:"bg-gradient-to-br from-purple-600 to-purple-700 rounded-xl p-6 text-white",renderId:"render-6de1e7b8",as:"div",children:[e.jsx(r,{className:"text-3xl font-bold mb-1",renderId:"render-267798f3",as:"div",children:t.total_invoices||0}),e.jsx(r,{className:"text-purple-200 text-sm",renderId:"render-5746cc88",as:"div",children:"Total Factures"})]}),e.jsxs(r,{className:"bg-gradient-to-br from-green-600 to-green-700 rounded-xl p-6 text-white",renderId:"render-37afd678",as:"div",children:[e.jsx(r,{className:"text-3xl font-bold mb-1",renderId:"render-3381b324",as:"div",children:t.active||0}),e.jsx(r,{className:"text-green-200 text-sm",renderId:"render-f9274809",as:"div",children:"Actives"})]}),e.jsxs(r,{className:"bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl p-6 text-white",renderId:"render-61154ed3",as:"div",children:[e.jsx(r,{className:"text-3xl font-bold mb-1",renderId:"render-aafe6deb",as:"div",children:t.used||0}),e.jsx(r,{className:"text-blue-200 text-sm",renderId:"render-902d172a",as:"div",children:"Utilisées"})]}),e.jsxs(r,{className:"bg-gradient-to-br from-yellow-600 to-yellow-700 rounded-xl p-6 text-white",renderId:"render-2801352d",as:"div",children:[e.jsx(r,{className:"text-3xl font-bold mb-1",renderId:"render-b57bda1b",as:"div",children:parseFloat(t.total_spent||0).toFixed(0)}),e.jsx(r,{className:"text-yellow-200 text-sm",renderId:"render-7726aa97",as:"div",children:"XOF Dépensés"})]})]}),e.jsxs(r,{className:"flex flex-wrap gap-3 mb-6",renderId:"render-47035454",as:"div",children:[e.jsxs(r,{className:"flex items-center gap-2 text-white",renderId:"render-7d46df2a",as:"div",children:[e.jsx(k,{className:"w-5 h-5"}),e.jsx(r,{className:"font-semibold",renderId:"render-14f74dfc",as:"span",children:"Filtrer:"})]}),B.map(s=>e.jsx(r,{onClick:()=>C(s.value),className:`px-4 py-2 rounded-lg font-semibold transition-all ${x===s.value?"bg-white text-purple-900 shadow-lg":"bg-purple-700 text-white hover:bg-purple-600"}`,renderId:"render-7ed1bde2",as:"button",children:s.label},s.value)),e.jsxs(r,{onClick:g,className:"ml-auto px-4 py-2 bg-gray-700 text-white rounded-lg font-semibold hover:bg-gray-600 transition-all flex items-center gap-2",renderId:"render-2cc8b3bc",as:"button",children:[e.jsx(Q,{className:"w-4 h-4"}),"Actualiser"]})]}),_?e.jsxs(r,{className:"text-center py-20",renderId:"render-8091f5bb",as:"div",children:[e.jsx(r,{className:"inline-block animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-purple-500 mb-4",renderId:"render-b0372481",as:"div"}),e.jsx(r,{className:"text-xl text-white",renderId:"render-1f32b16a",as:"p",children:"Chargement..."})]}):d.length===0?e.jsxs(r,{className:"text-center py-20 bg-white rounded-xl",renderId:"render-5b761d8a",as:"div",children:[e.jsx(j,{className:"w-24 h-24 text-gray-400 mx-auto mb-4 opacity-50"}),e.jsx(r,{className:"text-2xl font-bold text-gray-700 mb-2",renderId:"render-02f6630a",as:"h2",children:"Aucune facture"}),e.jsx(r,{className:"text-gray-500 mb-6",renderId:"render-4be77564",as:"p",children:x?"Aucune facture avec ce statut":"Vous n'avez pas encore de factures"}),e.jsx(r,{onClick:()=>c("/player/shop"),className:"px-6 py-3 bg-purple-600 text-white rounded-lg font-semibold hover:bg-purple-700 transition-all",renderId:"render-262cf922",as:"button",children:"Parcourir la Boutique"})]}):e.jsx(r,{className:"space-y-4",renderId:"render-6cc43c1f",as:"div",children:d.map(s=>{const a=S(s.status),n=a.icon,m=["pending","active"].includes(s.status)&&(!s.session_status||!["completed","expired","terminated"].includes(s.session_status)),i=s.days_until_expiry<=7&&s.days_until_expiry>0;return e.jsx(r,{className:"bg-white rounded-xl p-6 hover:shadow-xl transition-all",renderId:"render-967733fa",as:"div",children:e.jsxs(r,{className:"flex flex-col lg:flex-row lg:items-center gap-4",renderId:"render-bea0a37a",as:"div",children:[e.jsxs(r,{className:"flex-1 space-y-3",renderId:"render-3c1ab9e0",as:"div",children:[e.jsxs(r,{className:"flex items-start justify-between",renderId:"render-3ddb1f59",as:"div",children:[e.jsxs(r,{renderId:"render-6f7a8b46",as:"div",children:[e.jsx(r,{className:"text-xl font-bold text-gray-800 mb-1",renderId:"render-c942f0fe",as:"h3",children:s.invoice_number}),e.jsxs(r,{className:"flex items-center gap-2 text-sm text-gray-500",renderId:"render-6dd92685",as:"div",children:[e.jsx(U,{className:"w-4 h-4"}),P(s.issued_at)]})]}),e.jsxs(r,{className:`inline-flex items-center gap-1 px-3 py-1 rounded-full text-sm font-semibold ${a.className}`,renderId:"render-6cd2c0ad",as:"span",children:[e.jsx(n,{className:"w-4 h-4"}),a.label]})]}),e.jsxs(r,{className:"grid grid-cols-2 md:grid-cols-4 gap-4 pt-3 border-t",renderId:"render-2a45281b",as:"div",children:[e.jsxs(r,{renderId:"render-aa60eff7",as:"div",children:[e.jsx(r,{className:"text-gray-500 text-xs mb-1",renderId:"render-b599dadf",as:"div",children:"Jeu"}),e.jsxs(r,{className:"font-bold text-gray-800 flex items-center gap-1",renderId:"render-74606a33",as:"div",children:[e.jsx(M,{className:"w-4 h-4"}),s.game_name]})]}),e.jsxs(r,{renderId:"render-5be511ab",as:"div",children:[e.jsx(r,{className:"text-gray-500 text-xs mb-1",renderId:"render-04599cdc",as:"div",children:"Durée"}),e.jsxs(r,{className:"font-bold text-gray-800 flex items-center gap-1",renderId:"render-30325340",as:"div",children:[e.jsx(O,{className:"w-4 h-4"}),s.duration_minutes," min"]})]}),e.jsxs(r,{renderId:"render-602a0d49",as:"div",children:[e.jsx(r,{className:"text-gray-500 text-xs mb-1",renderId:"render-7efa3676",as:"div",children:"Montant"}),e.jsxs(r,{className:"font-bold text-green-600 flex items-center gap-1",renderId:"render-96367f57",as:"div",children:[e.jsx(K,{className:"w-4 h-4"}),s.amount," XOF"]})]}),e.jsxs(r,{renderId:"render-f28727e9",as:"div",children:[e.jsx(r,{className:"text-gray-500 text-xs mb-1",renderId:"render-92ad05ef",as:"div",children:"Expire"}),e.jsxs(r,{className:`font-bold flex items-center gap-1 ${i?"text-red-600":"text-gray-800"}`,renderId:"render-2ea0439e",as:"div",children:[e.jsx(v,{className:"w-4 h-4"}),T(s.expires_at)]})]})]}),i&&e.jsxs(r,{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 flex items-start gap-2",renderId:"render-1865862d",as:"div",children:[e.jsx(Y,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),e.jsxs(r,{className:"text-sm text-yellow-800",renderId:"render-8207ee88",as:"div",children:[e.jsx(r,{renderId:"render-625684da",as:"strong",children:"Attention:"})," Cette facture expire dans ",s.days_until_expiry," jour(s) !"]})]}),s.session_status&&e.jsx(r,{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",renderId:"render-7de522e9",as:"div",children:e.jsxs(r,{className:"text-sm text-blue-800",renderId:"render-b6227231",as:"div",children:[e.jsx(r,{renderId:"render-1ac20bcc",as:"strong",children:"Session:"})," ",s.session_remaining_minutes||0," minutes restantes"]})})]}),e.jsxs(r,{className:"flex flex-col gap-2 lg:min-w-[200px]",renderId:"render-44782a9f",as:"div",children:[m&&e.jsxs(r,{onClick:()=>E(s),className:"px-4 py-3 bg-gradient-to-r from-purple-600 to-indigo-600 text-white font-bold rounded-lg hover:from-purple-700 hover:to-indigo-700 transition-all flex items-center justify-center gap-2",renderId:"render-bca4085d",as:"button",children:[e.jsx(X,{className:"w-5 h-5"}),"Afficher QR Code"]}),!m&&s.session_status&&["completed","expired","terminated"].includes(s.session_status)&&e.jsxs(r,{className:"px-4 py-3 bg-gray-100 text-gray-600 font-semibold rounded-lg flex items-center justify-center gap-2",renderId:"render-cae6be68",as:"div",children:[e.jsx(p,{className:"w-5 h-5"}),"Session Terminée"]}),e.jsx(r,{className:"text-xs text-gray-500 text-center",renderId:"render-8c2b6809",as:"div",children:a.description})]})]})},s.id)})})]})}),A&&b&&e.jsx($,{invoice:b,onClose:()=>{h(!1),f(null)}})]})}if(typeof window<"u"){const c={NEXT_PUBLIC_API_BASE:"https://votre-domaine.infinityfreeapp.com/api",NEXT_PUBLIC_KKIAPAY_PUBLIC_KEY:"072b361d25546db0aee3d69bf07b15331c51e39f",NEXT_PUBLIC_KKIAPAY_SANDBOX:"0"};globalThis.process??={};const d=globalThis.process.env??{};globalThis.process.env=new Proxy(Object.assign({},c,d),{get(l,t){return t in l?l[t]:void 0},has(){return!0}})}const be=F(function(d){return e.jsx(D,{children:e.jsx(z,{...d})})});export{be as default};
