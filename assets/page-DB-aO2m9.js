import{r as o,u as y,d as _,i as S}from"./react-vendor-DYp0RFF0.js";import{j as e}from"./ui-vendor-DAbCkwHz.js";import{R as P}from"./layout-BhjoAR2P.js";import{C as s}from"./PolymorphicComponent-kLkD8TKY.js";import{N as C,A as I,C as A}from"./Navigation-KwyceX57.js";import{A as T}from"./apiBase-uKT1-15E.js";import{t as E}from"./index-ISQCChad.js";import{R as j}from"./refresh-cw-3nrt7UJ1.js";import{G as M}from"./gamepad-2-tiPnzinq.js";import{T as B}from"./timer-CkL3-bfF.js";import{C as N}from"./circle-alert-DQFIiAC-.js";import{P as w}from"./pause-BthwcmCB.js";import{C as L}from"./circle-check-big-cyHuzEaZ.js";import{C as R}from"./clock-CG-fk9kX.js";import{P as K}from"./play-ErchTkYN.js";import"./index-Birp5Yjg.js";import"./gamepad-DUfdRHsM.js";import"./createLucideIcon-BuqtEc0O.js";import"./users-CFhMAaaJ.js";import"./star-COodYRQY.js";import"./sparkles-CYj8vm4n.js";import"./trophy-i2KwZb7z.js";import"./x-B8NaV6qa.js";if(typeof window<"u"){const n={NEXT_PUBLIC_API_BASE:"https://votre-domaine.infinityfreeapp.com/api",NEXT_PUBLIC_KKIAPAY_PUBLIC_KEY:"072b361d25546db0aee3d69bf07b15331c51e39f",NEXT_PUBLIC_KKIAPAY_SANDBOX:"0"};globalThis.process??={};const t=globalThis.process.env??{};globalThis.process.env=new Proxy(Object.assign({},n,t),{get(d,a){return a in d?d[a]:void 0},has(){return!0}})}function D(n,t){const[d,a]=o.useState(n),[c,f]=o.useState(n?.remaining_minutes||0),[b,p]=o.useState(0),r=o.useRef(Date.now());o.useRef(null),o.useEffect(()=>{if(!d||d.status!=="active")return;const u=setInterval(()=>{const g=Date.now();Math.floor((g-r.current)/1e3),p(i=>{const l=i-1;return l<0?(f(x=>{const v=Math.max(0,x-1);return v===0&&t&&t(),v}),59):l})},1e3);return()=>clearInterval(u)},[d,t]),o.useEffect(()=>{n&&(a(n),f(n.remaining_minutes||0),p(0),r.current=Date.now())},[n]);const h=d?.total_minutes?Math.round((d.total_minutes-c)/d.total_minutes*100):0,m=d?.total_minutes?d.total_minutes-c:0;return{session:d,remainingMinutes:c,remainingSeconds:b,usedMinutes:m,progressPercent:h,totalMinutes:d?.total_minutes||0,isLowTime:c<=5&&c>0,isExpired:c===0}}if(typeof window<"u"){const n={NEXT_PUBLIC_API_BASE:"https://votre-domaine.infinityfreeapp.com/api",NEXT_PUBLIC_KKIAPAY_PUBLIC_KEY:"072b361d25546db0aee3d69bf07b15331c51e39f",NEXT_PUBLIC_KKIAPAY_SANDBOX:"0"};globalThis.process??={};const t=globalThis.process.env??{};globalThis.process.env=new Proxy(Object.assign({},n,t),{get(d,a){return a in d?d[a]:void 0},has(){return!0}})}function U(){const n=y(),[t,d]=o.useState(null),[a,c]=o.useState(!0),[f,b]=o.useState(Date.now()),p=o.useCallback(()=>{E.error("Votre session de jeu est terminée !",{duration:1e4,description:"Votre facture a été utilisée et est maintenant inactive."}),setTimeout(()=>{n("/player/my-purchases")},5e3)},[n]),r=D(t,p);o.useEffect(()=>{h()},[]),o.useEffect(()=>{if(!t||t.status!=="active")return;const i=setInterval(()=>{h()},3e4);return()=>clearInterval(i)},[t]);const h=async()=>{try{const l=await(await fetch(`${T}/player/my_active_session.php`,{credentials:"include"})).json();l.session?(d(l.session),b(Date.now())):d(null)}catch(i){console.error(i)}finally{c(!1)}},m=i=>{const l=Math.floor(i/60),x=i%60;return l>0?`${l}h ${x}min`:`${x}min`},u=i=>{const l={active:{bg:"bg-gradient-to-br from-green-600 to-green-700",text:"Session en cours",icon:K,pulse:!0},paused:{bg:"bg-gradient-to-br from-yellow-600 to-yellow-700",text:"Session en pause",icon:w,pulse:!1},ready:{bg:"bg-gradient-to-br from-blue-600 to-blue-700",text:"Session prête",icon:R,pulse:!1},completed:{bg:"bg-gradient-to-br from-gray-600 to-gray-700",text:"Session terminée",icon:L,pulse:!1}};return l[i]||l.ready},g=(i,l)=>{const x=i/l*100;return x>50?"from-green-500 to-green-600":x>20?"from-yellow-500 to-yellow-600":"from-red-500 to-red-600"};return e.jsxs(s,{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900",renderId:"render-0851e62d",as:"div",children:[e.jsx(C,{userType:"player",currentPage:"my-session"}),e.jsxs(s,{className:"lg:ml-64 p-4 md:p-8",renderId:"render-ae71956d",as:"div",children:[e.jsx(s,{className:"mb-8",renderId:"render-dd9c5405",as:"div",children:e.jsxs(s,{className:"flex items-center justify-between",renderId:"render-9f0cd221",as:"div",children:[e.jsxs(s,{renderId:"render-3fd69fe2",as:"div",children:[e.jsxs(s,{className:"text-4xl font-bold text-white mb-2 flex items-center gap-3",renderId:"render-e78c5d03",as:"h1",children:[e.jsx(I,{className:"w-10 h-10 text-purple-400"}),"Ma Session de Jeu"]}),e.jsxs(s,{className:"text-gray-400",renderId:"render-12265401",as:"p",children:["Décompte en temps réel • Sync serveur: ",Math.floor((Date.now()-f)/1e3),"s"]})]}),e.jsxs(s,{onClick:h,disabled:a,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-all disabled:opacity-50 flex items-center gap-2",renderId:"render-a3286ab9",as:"button",children:[e.jsx(j,{className:`w-4 h-4 ${a?"animate-spin":""}`}),"Synchroniser"]})]})}),a&&!r.session?e.jsxs(s,{className:"bg-white/10 backdrop-blur-lg rounded-xl p-12 text-center border border-white/20",renderId:"render-383f2161",as:"div",children:[e.jsx(j,{className:"w-12 h-12 text-purple-400 animate-spin mx-auto mb-4"}),e.jsx(s,{className:"text-gray-300",renderId:"render-9d07ff4a",as:"p",children:"Chargement de votre session..."})]}):r.session?e.jsxs(s,{className:"space-y-6",renderId:"render-b4aca001",as:"div",children:[e.jsxs(s,{className:`${u(r.session.status).bg} rounded-xl p-8 text-white relative overflow-hidden`,renderId:"render-47441f25",as:"div",children:[u(r.session.status).pulse&&e.jsx(s,{className:"absolute inset-0 bg-white/10 animate-pulse",renderId:"render-1142e610",as:"div"}),e.jsxs(s,{className:"relative z-10",renderId:"render-1be8d3c2",as:"div",children:[e.jsxs(s,{className:"flex items-center justify-between mb-6",renderId:"render-9f3c0de5",as:"div",children:[e.jsxs(s,{className:"flex items-center gap-4",renderId:"render-3283327f",as:"div",children:[_.createElement(u(r.session.status).icon,{className:"w-12 h-12"}),e.jsxs(s,{renderId:"render-c93a7f02",as:"div",children:[e.jsx(s,{className:"text-3xl font-bold",renderId:"render-a8612fb5",as:"div",children:u(r.session.status).text}),e.jsxs(s,{className:"text-white/80 text-sm",renderId:"render-58322b8e",as:"div",children:["Session #",r.session.id]})]})]}),r.session.status==="active"&&e.jsxs(s,{className:"text-right",renderId:"render-a8665c1a",as:"div",children:[e.jsx(s,{className:"text-sm text-white/80",renderId:"render-0d0ac439",as:"div",children:"Décompte live"}),e.jsx(s,{className:"text-2xl font-bold animate-pulse",renderId:"render-a54072e6",as:"div",children:"⏱️"})]}),(r.session.status==="completed"||r.isExpired)&&e.jsxs(s,{className:"bg-red-600/20 border-2 border-red-500 rounded-lg px-4 py-2 animate-pulse",renderId:"render-33cdf32d",as:"div",children:[e.jsx(s,{className:"text-red-100 font-bold",renderId:"render-2948a1d3",as:"div",children:"SESSION TERMINÉE"}),e.jsx(s,{className:"text-red-200 text-sm",renderId:"render-2a0b62bc",as:"div",children:"Redirection en cours..."})]})]}),e.jsxs(s,{className:"grid grid-cols-2 gap-4",renderId:"render-729e386d",as:"div",children:[e.jsxs(s,{className:"bg-white/10 rounded-lg p-4",renderId:"render-5a49c4a2",as:"div",children:[e.jsxs(s,{className:"flex items-center gap-2 text-white/80 text-sm mb-1",renderId:"render-a2a7de45",as:"div",children:[e.jsx(M,{className:"w-4 h-4"}),"Jeu"]}),e.jsx(s,{className:"text-xl font-semibold",renderId:"render-6d1f6366",as:"div",children:r.session.game_name})]}),e.jsxs(s,{className:"bg-white/10 rounded-lg p-4",renderId:"render-47da14a0",as:"div",children:[e.jsxs(s,{className:"flex items-center gap-2 text-white/80 text-sm mb-1",renderId:"render-d87db878",as:"div",children:[e.jsx(A,{className:"w-4 h-4"}),"Démarré le"]}),e.jsx(s,{className:"text-xl font-semibold",renderId:"render-3ff23038",as:"div",children:new Date(r.session.started_at||r.session.ready_at).toLocaleString("fr-FR",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"})})]})]})]})]}),e.jsxs(s,{className:"bg-white/10 backdrop-blur-lg rounded-xl p-8 border border-white/20",renderId:"render-9fb8cfdb",as:"div",children:[e.jsxs(s,{className:"flex items-center justify-between mb-4",renderId:"render-34929d22",as:"div",children:[e.jsxs(s,{className:"flex items-center gap-3",renderId:"render-f5abcff6",as:"div",children:[e.jsx(B,{className:"w-8 h-8 text-purple-400"}),e.jsx(s,{className:"text-2xl font-bold text-white",renderId:"render-62b462d7",as:"h3",children:"Temps de Jeu"})]}),r.isLowTime&&r.session.status==="active"&&e.jsxs(s,{className:"bg-red-600 text-white px-4 py-2 rounded-full flex items-center gap-2 animate-pulse",renderId:"render-a9d634aa",as:"div",children:[e.jsx(N,{className:"w-5 h-5"}),"Temps faible !"]})]}),e.jsxs(s,{className:"text-center mb-6",renderId:"render-37749e00",as:"div",children:[e.jsxs(s,{className:"text-6xl font-bold text-white mb-2 font-mono",renderId:"render-a7d4c61d",as:"div",children:[r.remainingMinutes,":",String(r.remainingSeconds).padStart(2,"0")]}),e.jsxs(s,{className:"text-gray-400",renderId:"render-48199c60",as:"div",children:["restant sur ",m(r.totalMinutes)]})]}),e.jsxs(s,{className:"relative",renderId:"render-bbe5316e",as:"div",children:[e.jsx(s,{className:"w-full bg-gray-700 rounded-full h-6 overflow-hidden",renderId:"render-ad6b7040",as:"div",children:e.jsx(s,{className:`h-full bg-gradient-to-r ${g(r.remainingMinutes,r.totalMinutes)} transition-all duration-1000`,style:{width:`${r.remainingMinutes/r.totalMinutes*100}%`},renderId:"render-09dbd04a",as:"div",children:e.jsx(s,{className:"h-full w-full bg-white/20 animate-pulse",renderId:"render-3b5131f1",as:"div"})})}),e.jsx(s,{className:"absolute inset-0 flex items-center justify-center",renderId:"render-d39a2af0",as:"div",children:e.jsxs(s,{className:"text-white font-bold text-sm drop-shadow-lg",renderId:"render-12074107",as:"span",children:[r.progressPercent,"%"]})})]}),e.jsxs(s,{className:"grid grid-cols-3 gap-4 mt-6",renderId:"render-9a95f0e3",as:"div",children:[e.jsxs(s,{className:"text-center",renderId:"render-c1290d0d",as:"div",children:[e.jsx(s,{className:"text-3xl font-bold text-white",renderId:"render-da102aa1",as:"div",children:m(r.totalMinutes)}),e.jsx(s,{className:"text-gray-400 text-sm",renderId:"render-9c4a47b7",as:"div",children:"Total acheté"})]}),e.jsxs(s,{className:"text-center",renderId:"render-e80e1646",as:"div",children:[e.jsx(s,{className:"text-3xl font-bold text-purple-400",renderId:"render-e705c0b5",as:"div",children:m(r.usedMinutes)}),e.jsx(s,{className:"text-gray-400 text-sm",renderId:"render-cddf3634",as:"div",children:"Utilisé"})]}),e.jsxs(s,{className:"text-center",renderId:"render-b9c80cfd",as:"div",children:[e.jsx(s,{className:"text-3xl font-bold text-green-400",renderId:"render-9000f0a5",as:"div",children:m(r.remainingMinutes)}),e.jsx(s,{className:"text-gray-400 text-sm",renderId:"render-f49b1d6b",as:"div",children:"Restant"})]})]})]}),r.session.pause_count>0&&e.jsx(s,{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",renderId:"render-55a3d9ca",as:"div",children:e.jsxs(s,{className:"flex items-center gap-3 text-yellow-400",renderId:"render-9d52d15e",as:"div",children:[e.jsx(w,{className:"w-6 h-6"}),e.jsxs(s,{renderId:"render-87ab3120",as:"div",children:[e.jsxs(s,{className:"font-semibold",renderId:"render-404ed3f5",as:"div",children:["Session mise en pause ",r.session.pause_count," fois"]}),e.jsxs(s,{className:"text-sm text-gray-400",renderId:"render-cd6d9b7a",as:"div",children:["Temps total de pause: ",m(r.session.total_pause_time||0)]})]})]})}),r.session.invoice_number&&e.jsxs(s,{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",renderId:"render-1adddcfe",as:"div",children:[e.jsx(s,{className:"text-lg font-semibold text-white mb-3",renderId:"render-4bb7aecf",as:"h4",children:"Informations de Facturation"}),e.jsxs(s,{className:"grid grid-cols-2 gap-4 text-sm",renderId:"render-90d96932",as:"div",children:[e.jsxs(s,{renderId:"render-d29dd202",as:"div",children:[e.jsx(s,{className:"text-gray-400",renderId:"render-f1ce535e",as:"div",children:"Numéro de facture"}),e.jsx(s,{className:"text-white font-mono",renderId:"render-2cef448b",as:"div",children:r.session.invoice_number})]}),e.jsxs(s,{renderId:"render-1003e677",as:"div",children:[e.jsx(s,{className:"text-gray-400",renderId:"render-c9631530",as:"div",children:"Code de validation"}),e.jsx(s,{className:"text-white font-mono",renderId:"render-6102997b",as:"div",children:r.session.validation_code})]})]})]}),e.jsx(s,{className:"bg-blue-600/20 border-2 border-blue-500 rounded-xl p-6",renderId:"render-ab0b44a4",as:"div",children:e.jsxs(s,{className:"flex items-start gap-3",renderId:"render-b1b93b8c",as:"div",children:[e.jsx(N,{className:"w-6 h-6 text-blue-400 flex-shrink-0 mt-1"}),e.jsxs(s,{className:"text-blue-100",renderId:"render-fe10418f",as:"div",children:[e.jsx(s,{className:"font-semibold mb-1",renderId:"render-11841bac",as:"div",children:"Comment ça fonctionne ?"}),e.jsxs(s,{className:"text-sm space-y-1 text-blue-200",renderId:"render-04faac6a",as:"ul",children:[e.jsx(s,{renderId:"render-c4c53c12",as:"li",children:"• Décompte en temps réel (chaque seconde) côté client"}),e.jsx(s,{renderId:"render-d6d7362f",as:"li",children:"• Synchronisation serveur toutes les 30 secondes"}),e.jsx(s,{renderId:"render-ffd1691c",as:"li",children:"• Alerte automatique à 5 minutes restantes"}),e.jsx(s,{renderId:"render-845fca65",as:"li",children:"• Redirection automatique quand le temps expire"}),e.jsx(s,{renderId:"render-5e24b5f4",as:"li",children:"• Aucun rechargement de page, fluidité maximale"})]})]})]})})]}):e.jsxs(s,{className:"bg-white/10 backdrop-blur-lg rounded-xl p-12 text-center border border-white/20",renderId:"render-f569b954",as:"div",children:[e.jsx(I,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx(s,{className:"text-2xl font-bold text-white mb-2",renderId:"render-68e6c0a0",as:"h3",children:"Aucune session active"}),e.jsx(s,{className:"text-gray-400 mb-6",renderId:"render-f9365018",as:"p",children:"Vous n'avez pas de session de jeu en cours actuellement."}),e.jsx(s,{href:"/player/shop",className:"inline-block px-6 py-3 bg-gradient-to-r from-purple-600 to-pink-600 text-white font-semibold rounded-xl hover:from-purple-700 hover:to-pink-700 transition-all shadow-lg",renderId:"render-1f0cf61d",as:"a",children:"Acheter du temps de jeu"})]})]})]})}if(typeof window<"u"){const n={NEXT_PUBLIC_API_BASE:"https://votre-domaine.infinityfreeapp.com/api",NEXT_PUBLIC_KKIAPAY_PUBLIC_KEY:"072b361d25546db0aee3d69bf07b15331c51e39f",NEXT_PUBLIC_KKIAPAY_SANDBOX:"0"};globalThis.process??={};const t=globalThis.process.env??{};globalThis.process.env=new Proxy(Object.assign({},n,t),{get(d,a){return a in d?d[a]:void 0},has(){return!0}})}const le=S(function(t){return e.jsx(P,{children:e.jsx(U,{...t})})});export{le as default};
